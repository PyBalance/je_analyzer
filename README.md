# è´¢åŠ¡æ•°æ®åˆ†æå‘½ä»¤è¡Œå·¥å…· (Journal Entries Analyzer)

ä¸€ä¸ªåŸºäº Python å’Œ Pandas çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå¿«é€Ÿåˆ†æå’Œç­›é€‰è´¢åŠ¡æ—¥è®°è´¦æ•°æ®ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **æ•°æ®æ¦‚è§ˆ**: ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Šï¼ŒåŒ…æ‹¬æ€»è®°å½•æ•°ã€å€Ÿæ–¹/è´·æ–¹é‡‘é¢åˆ†å¸ƒã€æ‘˜è¦è¯é¢‘åˆ†æ
- **æ•°æ®æŸ¥è¯¢**: çµæ´»ç­›é€‰å’Œå¯¼å‡ºåŸå§‹æ•°æ®
- **Top N æŸ¥è¯¢**: æŒ‰é‡‘é¢æ’åºè·å–å‰ N æ¡è®°å½•
- **é«˜çº§ç­›é€‰**: æ”¯æŒå¤æ‚çš„ Pandas æŸ¥è¯¢è¯­å¥
- **å¤šè´¦å¥—æ”¯æŒ**: å¯åˆ†æå•ä¸ªã€å¤šä¸ªæˆ–å…¨éƒ¨è´¦å¥—
- **è‡ªå®šä¹‰è¾“å‡º**: çµæ´»æ§åˆ¶è¾“å‡ºåˆ—

## å®‰è£…å’Œè¿è¡Œ

### æ¨èï¼šä½¿ç”¨ uvx ç›´æ¥è¿è¡Œ

æ— éœ€å®‰è£…ï¼Œç›´æ¥è¿è¡Œï¼š

```bash
# ä» GitHub è¿è¡Œ
uvx run git+https://github.com/PyBalance/je-analyzer --help

# ä»æœ¬åœ°æºç è¿è¡Œ
uvx run /path/to/je-analyzer --help

# å®é™…ä½¿ç”¨ç¤ºä¾‹
uvx run git+https://github.com/PyBalance/je-analyzer -a 1002 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx overview
```

### ä¼ ç»Ÿå®‰è£…æ–¹å¼

```bash
# ä½¿ç”¨ uv å®‰è£…
uv pip install git+https://github.com/yourusername/je-analyzer

# æˆ–è€…ä»æºç å®‰è£…
git clone https://github.com/yourusername/je-analyzer.git
cd je-analyzer
uv pip install -e .
```

å®‰è£…åå¯ç›´æ¥ä½¿ç”¨ï¼š

```bash
je-analyzer -a 1002 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx overview
```

## ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤æ ¼å¼

```bash
uv run python je_analyzer.py [OPTIONS] INPUT_FILE COMMAND [ARGS]...
```

**æ³¨æ„**: æ‰€æœ‰é€‰é¡¹ (`-a`, `-s`, `-e`, `-b`, `-q`) å¿…é¡»æ”¾åœ¨è¾“å…¥æ–‡ä»¶å’Œå­å‘½ä»¤ä¹‹å‰ã€‚

### å…¨å±€é€‰é¡¹

| é€‰é¡¹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `-a, --account-code` | âœ… | ä¼šè®¡ç§‘ç›®ç¼–ç  | `-a "1002"` |
| `--exact-match` | âŒ | ç²¾ç¡®åŒ¹é…ç§‘ç›®ç¼–ç ï¼ˆé»˜è®¤å‰ç¼€åŒ¹é…ï¼‰ | `--exact-match` |
| `-s, --start-date` | âœ… | å¼€å§‹æ—¥æœŸ (YYYY-MM-DD) | `-s "2024-01-01"` |
| `-e, --end-date` | âœ… | ç»“æŸæ—¥æœŸ (YYYY-MM-DD) | `-e "2024-12-31"` |
| `-b, --account-book` | âœ… | è´¦å¥—åç§° | `-b "ç¤ºä¾‹è´¦å¥—"` |
| `-q, --query` | âŒ | Pandas æŸ¥è¯¢å­—ç¬¦ä¸² | `-q "å€Ÿæ–¹é‡‘é¢ != 0"` |

### è´¦å¥—åç§°æ ¼å¼

- å•ä¸ªè´¦å¥—: `-b "ç¤ºä¾‹è´¦å¥—"`
- å¤šä¸ªè´¦å¥—: `-b "ç¤ºä¾‹è´¦å¥—A,ç¤ºä¾‹è´¦å¥—B"`
- å…¨éƒ¨è´¦å¥—: `-b "all"`

## å­å‘½ä»¤

### 1. overview - ç”Ÿæˆæ¦‚è§ˆæŠ¥å‘Š

ç”ŸæˆåŒ…å«ç»Ÿè®¡ä¿¡æ¯çš„æ•°æ®åˆ†ææŠ¥å‘Šã€‚

**è¯­æ³•**:
```bash
uv run python je_analyzer.py -a <CODE> -s <START> -e <END> -b <BOOK> <input_file> overview
```

**ç¤ºä¾‹**:

#### åŸºæœ¬æ¦‚è§ˆ
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 1002 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx overview
```

**è¾“å‡ºç¤ºä¾‹**:
```
============================================================
è´¢åŠ¡æ•°æ®åˆ†ææ¦‚è§ˆæŠ¥å‘Š
============================================================

ğŸ“Š åŸºæœ¬ç»Ÿè®¡
   æ€»è®°å½•æ•°: 6,067

ğŸ’° å€Ÿæ–¹é‡‘é¢åˆ†å¸ƒ
   å¹³å‡å€¼: 143,707.93
   ä¼—æ•°: 0.00
   ä¼—æ•°é¢‘ç‡: 5,279

ğŸ’³ è´·æ–¹é‡‘é¢åˆ†å¸ƒ
   å¹³å‡å€¼: 141,242.14
   ä¼—æ•°: 0.00
   ä¼—æ•°é¢‘ç‡: 788

ğŸ“ æ‘˜è¦è¯é¢‘åˆ†æ (Top 10)
    1. æ‰§è¡Œ: 2,962
    2. å·¥ç¨‹åˆåŒ: 2,648
    3. 01: 2,603
    4. æ‰‹ç»­è´¹: 1,788
    5. 2024: 1,268
    6. å…¨æ¬¾: 1,229
    7. 23: 871
    8. å†…éƒ¨: 856
    9. 2023: 789
   10. 02: 663

============================================================
```

#### ç²¾ç¡®åŒ¹é…ç§‘ç›®ç¼–ç 
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 1002 --exact-match -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx overview
```

#### åˆ†æå…¨éƒ¨è´¦å¥—
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 1002 -s 2024-01-01 -e 2024-12-31 -b "all" data.xlsx overview
```

### 2. get - è·å–åŸå§‹æ•°æ®

è·å–å¹¶è¾“å‡ºç­›é€‰åçš„åŸå§‹æ•°æ®è¡Œã€‚

**è¯­æ³•**:
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a <CODE> -s <START> -e <END> -b <BOOK> <input_file> get [OPTIONS]
```

**get é€‰é¡¹**:

| é€‰é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--top N` | è¿”å› Top N æ¡è®°å½• | `--top 5` |
| `--top-type TYPE` | æ’åºç±»å‹: `debit`, `credit`, `both` | `--top-type debit` |
| `--columns CONFIG` | è¾“å‡ºåˆ—é…ç½® | `--columns "æ—¥æœŸ,æ‘˜è¦,å€Ÿæ–¹é‡‘é¢"` |

**åˆ—é…ç½®é€‰é¡¹**:
- `all`: è¾“å‡ºæ‰€æœ‰åˆ—
- `default`: è¾“å‡ºé¢„è®¾åˆ—ï¼ˆè‡ªåŠ¨ç§»é™¤ç©ºåˆ—ï¼‰
- è‡ªå®šä¹‰åˆ—å: ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ `"æ—¥æœŸ,æ‘˜è¦,å€Ÿæ–¹é‡‘é¢"`

**ç¤ºä¾‹**:

#### è·å– Top 5 æ¡è®°å½•
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 6601 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx get --top 5
```

#### æŒ‰å€Ÿæ–¹é‡‘é¢æ’åº
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 6601 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx get --top 3 --top-type debit
```

#### è‡ªå®šä¹‰è¾“å‡ºåˆ—
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 6601 -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx get --top 3 --columns "æ—¥æœŸ,æ‘˜è¦,å€Ÿæ–¹é‡‘é¢,è´·æ–¹é‡‘é¢"
```

#### ä½¿ç”¨é«˜çº§æŸ¥è¯¢
```bash
uvx run git+https://github.com/PyBalance/je-analyzer -a 1002 -q "å€Ÿæ–¹é‡‘é¢ != 0" -s 2024-01-01 -e 2024-12-31 -b "ç¤ºä¾‹è´¦å¥—" data.xlsx get --top 5
```

## æŸ¥è¯¢è¯­æ³•

### åŸºæœ¬æŸ¥è¯¢

```bash
# å€Ÿæ–¹é‡‘é¢ä¸ç­‰äº0çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ != 0"

# è´·æ–¹é‡‘é¢ä¸ç­‰äº0çš„è®°å½•
-q "è´·æ–¹é‡‘é¢ != 0"

# å€Ÿæ–¹é‡‘é¢å¤§äº0çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ > 0"

# è´·æ–¹é‡‘é¢ç­‰äº0çš„è®°å½•
-q "è´·æ–¹é‡‘é¢ == 0"

# é‡‘é¢åœ¨ 10 ä¸‡åˆ° 50 ä¸‡ä¹‹é—´çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ >= 100000 and å€Ÿæ–¹é‡‘é¢ <= 500000"

# é‡‘é¢å¤§äº 100 ä¸‡çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ > 1000000"
```

### æ–‡æœ¬æœç´¢

```bash
# æ‘˜è¦åŒ…å«"æ‰‹ç»­è´¹"çš„è®°å½•
-q "æ‘˜è¦.str.contains('æ‰‹ç»­è´¹')"

# æ‘˜è¦ä»¥"è°ƒæ•´"å¼€å¤´çš„è®°å½•
-q "æ‘˜è¦.str.startswith('è°ƒæ•´')"

# æ‘˜è¦ä»¥"ç»“è½¬"ç»“å°¾çš„è®°å½•
-q "æ‘˜è¦.str.endswith('ç»“è½¬')"
```

### å¤åˆæŸ¥è¯¢

```bash
# é‡‘é¢å¤§äº 100 ä¸‡ä¸”æ‘˜è¦åŒ…å«"é“¶è¡Œ"çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ > 1000000 and æ‘˜è¦.str.contains('é“¶è¡Œ')"

# é‡‘é¢å¤§äº 50 ä¸‡æˆ–è´·æ–¹é‡‘é¢å¤§äº 50 ä¸‡çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ > 500000 or è´·æ–¹é‡‘é¢ > 500000"

# å€Ÿæ–¹é‡‘é¢ä¸ç­‰äº0ä¸”è´·æ–¹é‡‘é¢ç­‰äº0çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ != 0 and è´·æ–¹é‡‘é¢ == 0"

# å€Ÿæ–¹é‡‘é¢å¤§äº0æˆ–è´·æ–¹é‡‘é¢å¤§äº0çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ > 0 or è´·æ–¹é‡‘é¢ > 0"

# å€Ÿæ–¹é‡‘é¢ä¸ç­‰äº0ä¸”æ‘˜è¦åŒ…å«"æ‰‹ç»­è´¹"çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ != 0 and æ‘˜è¦.str.contains('æ‰‹ç»­è´¹')"
```

### å®é™…åº”ç”¨åœºæ™¯

```bash
# æ‰¾å‡ºæœ‰å®é™…å‘ç”Ÿé¢çš„è®°å½•ï¼ˆå€Ÿæ–¹æˆ–è´·æ–¹ä¸ä¸º0ï¼‰
-q "å€Ÿæ–¹é‡‘é¢ != 0 or è´·æ–¹é‡‘é¢ != 0"

# æ‰¾å‡ºåªæœ‰å€Ÿæ–¹é‡‘é¢çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ != 0 and è´·æ–¹é‡‘é¢ == 0"

# æ‰¾å‡ºåªæœ‰è´·æ–¹é‡‘é¢çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ == 0 and è´·æ–¹é‡‘é¢ != 0"

# æ‰¾å‡ºé‡‘é¢åœ¨ç‰¹å®šèŒƒå›´çš„è®°å½•
-q "å€Ÿæ–¹é‡‘é¢ >= 1000 and å€Ÿæ–¹é‡‘é¢ <= 10000"
```

**æ³¨æ„**: å½“æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­åŒ…å«ç©ºæ ¼çš„åˆ—åæ—¶ï¼Œéœ€è¦ä½¿ç”¨åå¼•å·åŒ…è£¹ï¼Œå¦‚ `å€Ÿæ–¹é‡‘é¢`ã€‚

## è¾“å‡ºæ ¼å¼

- **get å‘½ä»¤**: ä½¿ç”¨åˆ¶è¡¨ç¬¦ (\t) åˆ†éš”çš„è¡¨æ ¼æ ¼å¼ï¼Œä¾¿äºå¤åˆ¶åˆ° Excel æˆ–å…¶ä»–ç¨‹åº
- **overview å‘½ä»¤**: äººç±»å¯è¯»çš„æ ¼å¼åŒ–æŠ¥å‘Š

## æŠ€æœ¯è¦æ±‚

- Python 3.x
- uv (åŒ…ç®¡ç†å·¥å…·)
- pandas
- calamine (Excel è¯»å–å¼•æ“)
- click (å‘½ä»¤è¡Œè§£æ)

## å¸¸è§é—®é¢˜

### 1. å‘½ä»¤æ ¼å¼é”™è¯¯

**é”™è¯¯**: `Missing option '-a' / '--account-code'`

**è§£å†³**: ç¡®ä¿æ‰€æœ‰é€‰é¡¹æ”¾åœ¨è¾“å…¥æ–‡ä»¶å’Œå­å‘½ä»¤ä¹‹å‰ï¼š

```bash
# é”™è¯¯æ ¼å¼
uvx run git+https://github.com/PyBalance/je-analyzer data.xlsx overview -a "1002"

# æ­£ç¡®æ ¼å¼
uvx run git+https://github.com/PyBalance/je-analyzer -a "1002" data.xlsx overview
```

### 2. è´¦å¥—åç§°ä¸å­˜åœ¨

**é”™è¯¯**: `è­¦å‘Šï¼šè´¦å¥— 'xxx' ä¸å­˜åœ¨äºæ•°æ®ä¸­`

**è§£å†³**: æ£€æŸ¥å¯ç”¨çš„è´¦å¥—åç§°ï¼Œç¡®ä¿åç§°å®Œå…¨åŒ¹é…ã€‚

### 3. æŸ¥è¯¢è¯­æ³•é”™è¯¯

**é”™è¯¯**: `æŸ¥è¯¢è¯­æ³•é”™è¯¯`

**è§£å†³**: æ£€æŸ¥ Pandas æŸ¥è¯¢è¯­æ³•ï¼Œç‰¹åˆ«æ˜¯åŒ…å«ç©ºæ ¼çš„åˆ—åéœ€è¦ä½¿ç”¨åå¼•å·ã€‚

## é¡¹ç›®ç»“æ„

```
je_analyzer/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ je_analyzer/
â”‚       â”œâ”€â”€ __init__.py   # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”‚       â”œâ”€â”€ main.py      # ä¸»ç¨‹åºæ–‡ä»¶
â”‚       â””â”€â”€ __main__.py   # æ¨¡å—å…¥å£ç‚¹
â”œâ”€â”€ dev/
â”‚   â””â”€â”€ DESIGN.md          # è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ test-data/
â”‚   â””â”€â”€ sample_data.xlsx  # æµ‹è¯•æ•°æ®æ–‡ä»¶
â”œâ”€â”€ pyproject.toml        # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ LICENSE               # è®¸å¯è¯æ–‡ä»¶
â”œâ”€â”€ README.md             # æ–‡æ¡£
â””â”€â”€ INSTALL.md            # å®‰è£…æŒ‡å—
```

## è®¸å¯è¯

[è¯·æ·»åŠ è®¸å¯è¯ä¿¡æ¯]